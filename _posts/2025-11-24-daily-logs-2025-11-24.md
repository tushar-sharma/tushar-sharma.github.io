---
published: false
tags:
 - postgresql
---

## Reading list

1. [PostgreSQL Find Locks](https://fluca1978.github.io/2017/11/15/PostgreSQL_Find_Locks.html)

2. [Everyting You need to now about PostgerSQL Locks Practical Skills](https://mohitmishra786.github.io/chessman/2025/03/02/Everything-You-Need-to-Know-About-PostgreSQL-Locks-Practical-Skills-You-Need.html)


## Locks in Postgresql 

To check whether any transaction is currently waiting on a lock, start with the **pg_stat_activity** view. This shows all active sessions and whether they are blocked.

```sql
SELECT
    query,
    backend_start,
    xact_start,
    query_start,
    state_change,
    state,
    now()::time - state_change::time AS locked_since,
    pid,
    wait_event_type,
    wait_event
FROM pg_stat_activity
WHERE wait_event_type IS NOT NULL
ORDER BY locked_since DESC;

```

This helps you identify which session (pid) is waiting and how long it has been blocked. Once you have the pid, use pg_locks to inspect what type of lock the session is waiting for and whether it has been granted:


```sql
SELECT
    a.usename,
    a.application_name,
    a.datname,
    a.query,
    l.granted,
    l.mode,
    l.transactionid
FROM pg_locks l
JOIN pg_stat_activity a ON a.pid = l.pid
WHERE l.granted = false
  AND a.pid = <PID>;

 ```
 
 ## Disable Overtype mode in NuPhy keyboard
 
 `Fn + Delete`.
